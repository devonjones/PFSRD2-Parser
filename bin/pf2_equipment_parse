#!/usr/bin/env python
import sys
import os
from pfsrd2.equipment import parse_equipment
from universal.warnings import WarningReporting
from universal.options import exec_main, option_parser


def main():
    usage = "usage: %prog [options] --type TYPE [filenames]\nParses equipment (weapons, armor, shields) from pfsrd2 html to json and writes them to the specified directory"
    parser = option_parser(usage)
    parser.add_option("--type", dest="equipment_type", help="Equipment type: weapon, armor, or shield")
    (options, args) = parser.parse_args()

    if not options.equipment_type:
        parser.error("--type is required (weapon, armor, or shield)")

    if options.equipment_type not in ['weapon', 'armor', 'shield']:
        parser.error(f"Invalid equipment type: {options.equipment_type}. Must be weapon, armor, or shield")

    exec_main(options, args, parse_equipment, options.equipment_type)


if __name__ == "__main__":
    sys.exit(main())
